#Install
install.packages("ggplot2")
# Use mpg dataset
summary(mpg)
# Get help
help(summary)
library(ggplot2)
# Use mpg dataset
summary(mpg)
help(summary)
?summary
head(mpg)
tail(mpg)
summary(mpg$displ)
mpg$displ
# Basic scatter plot
plot(mpg$displ, mpg$hwy, main = "Engine Displacement vs Highway MPG",
xlab = "Engine Displacement (liters)", ylab = "Highway MPG")
# Basic line plot
plot(mpg$displ, mpg$hwy, type="l", main = "Engine Displacement vs Highway MPG",
xlab = "Engine Displacement (liters)", ylab = "Highway MPG")
# Histogram
hist(mpg$hwy, main = "Histogram of Highway MPG", xlab = "Highway MPG", col = "lightblue", breaks = 20)
# Box plot
boxplot(hwy ~ class, data = mpg, main = "Highway MPG by Car Class",
xlab = "Car Class", ylab = "Highway MPG", col = "orange")
# Scatter plot with title and axis labels
plot(mpg$displ, mpg$hwy, main = "Engine Displacement vs Highway MPG",
xlab = "Displacement (liters)", ylab = "Highway MPG", pch = 19, col = "blue")
# Scatter plot with title and axis labels
plot(mpg$displ, mpg$hwy, main = "Engine Displacement vs Highway MPG",
xlab = "Displacement (liters)", ylab = "Highway MPG", pch = 11, col = "blue")
legend("topright", legend = "MPG Data", col = "blue", pch = 19)
# Save the scatter plot to a PNG file
png("displ_vs_hwy.png")
plot(mpg$displ, mpg$hwy, main = "Displacement vs Highway MPG",
xlab = "Displacement (liters)", ylab = "Highway MPG", pch = 19, col = "blue")
dev.off()
ggplot(data=mpg, mapping=aes(x=displ, y=hwy))
# Scatterplot
ggplot(mpg, mapping=aes(displ,hwy))
ggplot(mpg, mapping=aes(displ,hwy))+geom_point()
ggplot(mpg, mapping=aes(displ,hwy))+geom_line()
ggplot(mpg,aes(class))+geom_bar()
ggplot(mpg,aes(drv, hwy))+geom_boxplot()
p=ggplot(mpg, aes(displ,hwy, color=class)) +
geom_point()
p
p+theme(plot.title=element_text(size=30, face="bold"),
axis.text.x=element_text(size=10),
axis.text.y=element_text(size=15),
axis.title.x=element_text(size=20),
axis.title.y=element_text(size=25))
p+labs(title="Black and white theme")+theme_bw()
p+labs(title="Black and white theme")+theme_dark()
p+labs(title="Black and white theme")+theme_minimal()
# Scatterplot
ggplot(mpg, mapping=aes(displ,hwy))+geom_point(size=5)
# Scatterplot
ggplot(mpg, mapping=aes(displ,hwy))+geom_point(size=5, color='red')
# Scatterplot
ggplot(mpg, mapping=aes(displ,hwy))+geom_point(size=5, color=class)
# Scatterplot
ggplot(mpg, mapping=aes(displ,hwy, color=factor(cyl)))+geom_point()
ggplot(mpg, mapping=aes(displ,hwy, color=factor(cyl)))+geom_point(aes(shape = drv))
ggplot(mpg, mapping=aes(displ,hwy))+geom_point()+geom_line()
ggplot(mpg, mapping=aes(displ,hwy))+geom_smooth()
ggplot(mpg, mapping=aes(displ,hwy))+geom_smooth(method = "lm")
ggplot(mpg, mapping=aes(displ,hwy))+geom_smooth(method = "lm", se=FALSE)+geom_point()
ggplot(mpg,aes(class,fill=drv))+geom_bar()
ggplot(mpg,aes(drv, hwy))+geom_smooth(method = "lm", se=FALSE)+geom_point()+facet_wrap(~year)
ggplot(mpg,aes(drv, hwy))+geom_smooth(method = "lm", se=FALSE)+geom_point()+facet_wrap(~year)
ggplot(mpg,aes(drv, hwy))+geom_smooth(method = "lm", se=FALSE)+geom_point()+facet_wrap(~class)
ggplot(mpg,aes(displ, hwy))+geom_smooth(method = "lm", se=FALSE)+
geom_point()+facet_grid(class~year)
library(RColorBrewer)
display.brewer.all()
display.brewer.all(colorblindFriendly = TRUE)
ggplot(mpg,aes(class,fill=drv))+geom_bar()+scale_fill_brewer(pallete="Purples")
ggplot(mpg,aes(class,fill=drv))+geom_bar()+scale_fill_brewer(palete="Purples")
ggplot(mpg,aes(class,fill=drv))+geom_bar()+scale_fill_brewer(palette="Purples")
ggplot(mpg,aes(class,fill=drv))+geom_bar()+scale_fill_brewer(palette="Set2")
my_palette=c("#E69F00", "#56B4E9","#cc79a7")
ggplot(mpg,aes(class,fill=drv))+geom_bar()+scale_color_manual(values = my_palette)
ggplot(mpg,aes(class,fill=drv))+geom_bar()+scale_fill_manual(values = my_palette)
my_palette=c("#f98b0d", "#085bde","#fa216d")
ggplot(mpg,aes(class,fill=drv))+geom_bar()+scale_fill_manual(values = my_palette)
library("ggplot2")
rm(list=ls())
ggplot(mpg, aes(cty, hwy)) +
geom_point(alpha = 1 / 3) +
xlab("city driving (mpg)") +
ylab("highway driving (mpg)")
ggplot(mpg, aes(drv, hwy)) +
geom_jitter(width = 0.25)
ggplot(mpg, aes(drv, hwy)) +
geom_jitter(width = 0.25) +
xlim("f", "r") +
ylim(20, 30)
ggplot(data = mpg, mapping = aes(x = class, y = hwy)) +
geom_boxplot()
ggplot(data = mpg, mapping = aes(x = class, y = hwy)) +
geom_boxplot() +
coord_flip()
ggplot(data = mpg) +
stat_summary(
mapping = aes(x = class, y = hwy),
fun.min = min,
fun.max = max,
fun = median
)
ggplot(oz_states) +
geom_sf() +
coord_sf() +
geom_sf_label(aes(label = NAME), size = 3, label.padding = unit(0.2, "lines")) +  # Adding state name labels
theme_minimal() +
labs(title = "Map of Australian States with Labels")
library(ozmaps)
ggplot(oz_states) +
geom_sf() +
coord_sf()
ggplot(oz_states) +
geom_sf() +
coord_sf() +
geom_sf_label(aes(label = NAME), size = 3, label.padding = unit(0.2, "lines")) +  # Adding state name labels
theme_minimal() +
labs(title = "Map of Australian States with Labels")
library("maps")
world_map= map_data("world")
library(dplyr)
library(ggplot2)
# Filter out missing values and group by opening_name and the average white and black ratings
opening_ratings <- chess %>%
filter(!is.na(opening_name), !is.na(white_rating), !is.na(black_rating)) %>%
group_by(opening_name) %>%
summarize(
avg_white_rating = mean(white_rating, na.rm = TRUE),
avg_black_rating = mean(black_rating, na.rm = TRUE),
games_played = n()
) %>%
arrange(desc(games_played))
install.packages("readr")
#ISTE 782  October 1, 2024 Tuesday
chess <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-10-01/chess.csv')
head(chess)
library(dplyr)
library(ggplot2)
# Filter out missing values and group by opening_name and the average white and black ratings
opening_ratings <- chess %>%
filter(!is.na(opening_name), !is.na(white_rating), !is.na(black_rating)) %>%
group_by(opening_name) %>%
summarize(
avg_white_rating = mean(white_rating, na.rm = TRUE),
avg_black_rating = mean(black_rating, na.rm = TRUE),
games_played = n()
) %>%
arrange(desc(games_played))
# View the summarized data (optional)
head(opening_ratings)
# Plotting the common openings by number of games played
ggplot(opening_ratings, aes(x = reorder(opening_name, -games_played), y = games_played)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Most Common Chess Openings", x = "Opening Name", y = "Games Played") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Plotting opening moves by rank
ggplot(opening_ratings, aes(x = reorder(opening_name, -avg_white_rating), y = avg_white_rating)) +
geom_bar(stat = "identity", fill = "orange") +
labs(title = "Average White Player Rating by Opening", x = "Opening Name", y = "Average White Rating") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(opening_ratings, aes(x = reorder(opening_name, -avg_black_rating), y = avg_black_rating)) +
geom_bar(stat = "identity", fill = "purple") +
labs(title = "Average Black Player Rating by Opening", x = "Opening Name", y = "Average Black Rating") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
install.packages("readr")
# Save clean data
write_csv(df_clean, "Data/processed/diabetes_readmission_clean.csv")
library(dplyr)
library(readr)
# Load raw data
df_raw <- read_csv("Data/diabetic_data.csv")
# Load raw data
df_raw <- read_csv("/Data/diabetic_data.csv")
# Load raw data
df_raw <- read_csv("Portfolio_Projects/Healthcare_Readmission/Data/diabetic_data.csv")
library(dplyr)
library(readr)
# Load raw data
df_raw <- read_csv("Portfolio_Projects/Healthcare_Readmission/Data/diabetic_data.csv")
setwd("C:/Users/jueel/Jueeli_rit/Portfolio_Projects/Healthcare_Readmission")
library(dplyr)
library(readr)
# Load raw data
df_raw <- read_csv("Portfolio_Projects/Healthcare_Readmission/Data/diabetic_data.csv")
# Load raw data
df_raw <- read_csv("/Portfolio_Projects/Healthcare_Readmission/Data/diabetic_data.csv")
# Load raw data
df_raw <- read_csv("C:/Users/jueel/Jueeli_rit/Portfolio_Projects/Healthcare_Readmission/Data/diabetic_data.csv")
df_clean <- df_raw %>%
# Replace "?" with NA
mutate(across(everything(), ~na_if(., "?"))) %>%
# Keep Male / Female only
filter(gender %in% c("Male", "Female")) %>%
# Create binary target for 30-day readmission
mutate(readmit_30 = ifelse(readmitted == "<30", 1, 0)) %>%
# Convert age bracket "[70-80)" into numeric midpoint
mutate(age_mid = case_when(
age == "[0-10)" ~ 5,
age == "[10-20)" ~ 15,
age == "[20-30)" ~ 25,
age == "[30-40)" ~ 35,
age == "[40-50)" ~ 45,
age == "[50-60)" ~ 55,
age == "[60-70)" ~ 65,
age == "[70-80)" ~ 75,
age == "[80-90)" ~ 85,
age == "[90-100)" ~ 95,
TRUE ~ NA_real_
)) %>%
# Convert these to numeric
mutate(across(
c(time_in_hospital,
num_lab_procedures,
num_procedures,
num_medications,
number_outpatient,
number_emergency,
number_inpatient),
as.numeric
))
df_clean <- df_clean %>%
select(
readmit_30,
age_mid,
gender,
time_in_hospital,
num_lab_procedures,
num_procedures,
num_medications,
number_outpatient,
number_emergency,
number_inpatient,
A1Cresult,
max_glu_serum
)
library(dplyr)
library(readr)
# Load raw data
df_raw <- read_csv("C:/Users/jueel/Jueeli_rit/Portfolio_Projects/Healthcare_Readmission/Data/diabetic_data.csv")
#"C:\Users\jueel\Jueeli_rit\Portfolio_Projects\Healthcare_Readmission\Data\diabetic_data.csv"
# -------------------------
# CLEANING
# -------------------------
df_clean <- df_raw %>%
# Replace "?" with NA
mutate(across(everything(), ~na_if(., "?"))) %>%
# Keep Male / Female only
filter(gender %in% c("Male", "Female")) %>%
# Create binary target for 30-day readmission
mutate(readmit_30 = ifelse(readmitted == "<30", 1, 0)) %>%
# Convert age bracket "[70-80)" into numeric midpoint
mutate(age_mid = case_when(
age == "[0-10)" ~ 5,
age == "[10-20)" ~ 15,
age == "[20-30)" ~ 25,
age == "[30-40)" ~ 35,
age == "[40-50)" ~ 45,
age == "[50-60)" ~ 55,
age == "[60-70)" ~ 65,
age == "[70-80)" ~ 75,
age == "[80-90)" ~ 85,
age == "[90-100)" ~ 95,
TRUE ~ NA_real_
)) %>%
# Convert these to numeric
mutate(across(
c(time_in_hospital,
num_lab_procedures,
num_procedures,
num_medications,
number_outpatient,
number_emergency,
number_inpatient),
as.numeric
))
library(dplyr)
# 1. Set working directory to project root
setwd("C:/Users/jueel/Jueeli_rit/Portfolio_Projects/Healthcare_Readmission")
# 2. Load raw data and convert "?" to NA directly
df_raw <- read.csv(
"Data/diabetic_data.csv",
na.strings = c("?", "NA", "")
)
# 3. Clean + transform
df_clean <- df_raw %>%
# Keep only Male / Female
filter(gender %in% c("Male", "Female")) %>%
# Binary target: 1 = readmitted within 30 days, 0 = otherwise
mutate(
readmit_30 = ifelse(readmitted == "<30", 1, 0),
# Convert age bracket to numeric midpoint
age_mid = dplyr::case_when(
age == "[0-10)"   ~ 5,
age == "[10-20)"  ~ 15,
age == "[20-30)"  ~ 25,
age == "[30-40)"  ~ 35,
age == "[40-50)"  ~ 45,
age == "[50-60)"  ~ 55,
age == "[60-70)"  ~ 65,
age == "[70-80)"  ~ 75,
age == "[80-90)"  ~ 85,
age == "[90-100)" ~ 95,
TRUE ~ NA_real_
)
) %>%
# Make sure key numeric columns are numeric
mutate(across(
c(time_in_hospital,
num_lab_procedures,
num_procedures,
num_medications,
number_outpatient,
number_emergency,
number_inpatient),
as.numeric
)) %>%
# Keep only the columns we actually need for modeling + Shiny
select(
readmit_30,
age_mid,
gender,
time_in_hospital,
num_lab_procedures,
num_procedures,
num_medications,
number_outpatient,
number_emergency,
number_inpatient,
A1Cresult,
max_glu_serum
) %>%
# Drop rows missing basic essentials
filter(
!is.na(age_mid),
!is.na(time_in_hospital)
)
# 4. Create processed folder if it doesn't exist
if (!dir.exists("data/processed")) {
dir.create("data/processed", recursive = TRUE)
}
# 5. Save cleaned data
write.csv(
df_clean,
"data/processed/diabetes_readmission_clean.csv",
row.names = FALSE
)
cat("âœ… Cleaning complete! Saved to data/processed/diabetes_readmission_clean.csv\n")
df_clean <- read.csv("Data/processed/diabetes_readmission_clean.csv")
str(df_clean)
head(df_clean)
cat("AUC:", auc_value, "\n")
# 1. Set working directory to project root
setwd("C:/Users/jueel/Jueeli_rit/Portfolio_Projects/Healthcare_Readmission")
# 2. Load libraries
library(dplyr)
library(ggplot2)
library(caret)
# 1. Set working directory to project root
setwd("C:/Users/jueel/Jueeli_rit/Portfolio_Projects/Healthcare_Readmission")
# 2. Load libraries
library(dplyr)
library(ggplot2)
library(caret)
library(pROC)
df <- read.csv("Data/processed/diabetes_readmission_clean.csv")
# Quick structure check
str(df)
# Overall 30-day readmission rate
overall_rate <- mean(df$readmit_30 == 1)
cat("Overall 30-day readmission rate:", round(overall_rate * 100, 2), "%\n")
# Readmission by gender
df %>%
group_by(gender) %>%
summarise(
readmit_rate = mean(readmit_30 == 1),
n = n()
) %>%
arrange(desc(readmit_rate)) %>%
print()
# Readmission by age group
df_age <- df %>%
mutate(age_group = cut(
age_mid,
breaks = c(0, 30, 45, 60, 75, 100),
labels = c("0-30", "31-45", "46-60", "61-75", "76+")
)) %>%
group_by(age_group) %>%
summarise(readmit_rate = mean(readmit_30 == 1),
n = n())
print(df_age)
# Optional: plot readmission rate by age group
ggplot(df_age, aes(x = age_group, y = readmit_rate)) +
geom_col() +
labs(title = "30-day Readmission Rate by Age Group",
x = "Age Group",
y = "Readmission Rate")
# Prepare data for modeling
df_model <- df %>%
select(
readmit_30,
age_mid,
gender,
time_in_hospital,
num_lab_procedures,
num_procedures,
num_medications,
number_outpatient,
number_emergency,
number_inpatient
) %>%
na.omit()
# Convert to factors where needed
df_model$readmit_30 <- factor(df_model$readmit_30, levels = c(0, 1))
df_model$gender <- factor(df_model$gender)
set.seed(123)
train_idx <- createDataPartition(df_model$readmit_30, p = 0.7, list = FALSE)
train <- df_model[train_idx, ]
test  <- df_model[-train_idx, ]
# Fit logistic regression
logit_model <- glm(
readmit_30 ~ .,
data = train,
family = binomial
)
summary(logit_model)
# Predict probabilities on test set
test$pred_prob <- predict(logit_model, newdata = test, type = "response")
# Convert probabilities to class labels (0.5 threshold)
test$pred_class <- ifelse(test$pred_prob >= 0.5, 1, 0)
test$pred_class <- factor(test$pred_class, levels = c(0, 1))
# Confusion matrix
cm <- confusionMatrix(test$pred_class, test$readmit_30, positive = "1")
print(cm)
# ROC & AUC
roc_obj <- roc(
response = test$readmit_30,
predictor = test$pred_prob,
levels = c("0", "1")
)
auc_value <- auc(roc_obj)
cat("AUC:", auc_value, "\n")
# -----------------------------
# Save model if you want to reuse outside this script
# -----------------------------
saveRDS(logit_model, "Data/processed/logit_model_readmit30.rds")
cat("Model saved to Data/processed/logit_model_readmit30.rds\n")
logit_model_readmit30 <- readRDS("C:/Users/jueel/Jueeli_rit/Portfolio_Projects/Healthcare_Readmission/Data/processed/logit_model_readmit30.rds")
View(logit_model_readmit30)
shiny::runApp()
runApp()
install.packages("shinydashboard")
runApp()
install.packages("shinydashboard")
runApp()
shiny::runApp()
shiny::runApp()
